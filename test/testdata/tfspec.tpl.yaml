apiVersion: ctl.isla.solutions/v1
kind: {{.Kind}}
metadata:
  name: {{.Name}}
spec:
  image: {{.Image}}
  imagePullPolicy: Always
  backendBucket: {{.BackendBucket}}
  backendPrefix: {{.BucketPrefix}}
  providerConfig:
  - name: google
    secretName: {{.GoogleProviderSecretName}}
  sources:
  {{- range .ConfigMapSources }}
  - configMap:
      name: {{ . }}
    trigger: true
  {{- end }}
{{- range .EmbeddedSources }}
  - embedded: |-
{{ . | indent 6 }}
  {{- end }}
  {{- range .TFSources }}
  {{- range $k, $v := .}} 
  - {{ $k }}: {{ $v }}
  {{- end }}
  {{- end }}
  {{- if .TFPlan }}
  tfplan: {{ .TFPlan }}
  {{- end }}
  {{- if .TFVarsMap }}
  tfvars:
  {{- range $k, $v := .TFVarsMap}}
  - name: {{ $k }}
    value: {{ $v }}
  {{- end}}
  {{- end }}